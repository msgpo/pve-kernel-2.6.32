Index: newovs/acinclude.m4
===================================================================
--- newovs.orig/acinclude.m4	2014-08-14 22:34:33.000000000 +0200
+++ newovs/acinclude.m4	2014-09-18 06:50:07.000000000 +0200
@@ -257,6 +257,7 @@
   OVS_GREP_IFELSE([$KSRC/include/linux/netdevice.h], [can_checksum_protocol])
   OVS_GREP_IFELSE([$KSRC/include/linux/netdevice.h], [netdev_features_t])
   OVS_GREP_IFELSE([$KSRC/include/linux/netdevice.h], [pcpu_sw_netstats])
+  OVS_GREP_IFELSE([$KSRC/include/net/net_namespace.h], [pernet_operations])
 
   OVS_GREP_IFELSE([$KSRC/include/linux/random.h], [prandom_u32])
 
Index: newovs/datapath/linux/compat/net_namespace.c
===================================================================
--- newovs.orig/datapath/linux/compat/net_namespace.c	2014-07-14 12:28:51.000000000 +0200
+++ newovs/datapath/linux/compat/net_namespace.c	2014-09-18 06:52:24.000000000 +0200
@@ -3,7 +3,7 @@
 #include <net/net_namespace.h>
 #include <net/netns/generic.h>
 
-#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,33)
+#ifndef HAVE_PERNET_OPERATIONS
 
 int compat_init_net(struct net *net, struct rpl_pernet_operations *pnet)
 {
Index: newovs/datapath/linux/compat/include/net/net_namespace.h
===================================================================
--- newovs.orig/datapath/linux/compat/include/net/net_namespace.h	2014-07-14 12:28:51.000000000 +0200
+++ newovs/datapath/linux/compat/include/net/net_namespace.h	2014-09-18 06:55:31.000000000 +0200
@@ -3,7 +3,7 @@
 
 #include_next <net/net_namespace.h>
 
-#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,33)
+#ifndef HAVE_PERNET_OPERATIONS
 /* for 2.6.32* */
 struct rpl_pernet_operations {
 	int (*init)(struct net *net);
